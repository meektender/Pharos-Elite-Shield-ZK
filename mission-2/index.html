<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Olympic Lounge | ZK-Gate</title>
    <script src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/snarkjs@0.7.0/build/snarkjs.min.js"></script>
    <style>
        body { 
            background-color: #020617; 
            color: #f8fafc; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            min-height: 100vh; 
            margin: 0; 
            overflow: hidden;
        }
        #gatekeeper { 
            text-align: center; 
            max-width: 450px; 
            width: 90%;
            padding: 40px; 
            border: 1px solid #1e293b; 
            border-radius: 24px; 
            background: #0f172a; 
            box-shadow: 0 20px 50px rgba(0,0,0,0.7); 
        }
        h1 { color: #60a5fa; margin-bottom: 10px; }
        .description { color: #94a3b8; line-height: 1.6; margin-bottom: 30px; }

        button { 
            width: 100%; 
            padding: 14px; 
            border-radius: 12px; 
            border: none; 
            font-weight: bold; 
            font-size: 16px;
            cursor: pointer; 
            transition: all 0.3s ease; 
        }

        #connectBtn { background: #3b82f6; color: white; }
        #connectBtn:hover { background: #2563eb; transform: translateY(-2px); }

        #verifyBtn { 
            background: transparent; 
            border: 2px solid #3b82f6; 
            color: #3b82f6; 
            display: none; 
        }
        #verifyBtn:hover:not(:disabled) { background: rgba(59, 130, 246, 0.1); }
        #verifyBtn:disabled { border-color: #475569; color: #475569; cursor: wait; }

        #status { font-size: 14px; color: #64748b; margin-top: 20px; font-family: monospace; }

        #loungeContent { 
            display: none; 
            text-align: center; 
            color: #fbbf24; 
            animation: slideUp 0.8s ease-out; 
        }

        @keyframes slideUp { 
            from { opacity: 0; transform: translateY(30px); } 
            to { opacity: 1; transform: translateY(0); } 
        }

        .secret-box {
            padding: 25px; 
            border: 2px dashed #f59e0b; 
            border-radius: 16px; 
            background: rgba(245, 158, 11, 0.05); 
            margin-top: 30px;
        }
    </style>
</head>
<body>

    <div id="gatekeeper">
        <div style="font-size: 50px; margin-bottom: 10px;">üèõÔ∏è</div>
        <h1>The Olympic Lounge</h1>
        <p class="description">Pharos Mission 2: The Gatekeeper.<br>Prove your eligibility without revealing your identity.</p>

        <button id="connectBtn" onclick="connect()">1. Connect Wallet</button>
        <button id="verifyBtn" onclick="enterLounge()">2. Generate ZK-Proof & Enter</button>

        <p id="status">Status: Identity Unverified</p>
    </div>

    <div id="loungeContent">
        <div style="font-size: 60px;">üèÜ</div>
        <h1>Access Granted</h1>
        <p>Your ZK-Snark proof has been verified on-chain.</p>

        <div class="secret-box">
            <p style="margin: 0; font-size: 18px;"><b>MISSION 2 LOG:</b></p>
            <p style="color: #fcd34d; font-family: monospace;">[SUCCESS] Gatekeeper Bypassed via Zero-Knowledge</p>
        </div>
    </div>

    <script>
        // Use unique variables for the UI
        const statusText = document.getElementById('status');
        const connectBtn = document.getElementById('connectBtn');
        const verifyBtn = document.getElementById('verifyBtn');
        const gatekeeper = document.getElementById('gatekeeper');
        const loungeContent = document.getElementById('loungeContent');

        async function connect() {
            if (typeof window.ethereum !== 'undefined') {
                try {
                    statusText.innerText = "Status: Authorizing MetaMask...";
                    const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                    const account = accounts[0];

                    statusText.innerText = "Connected: " + account.substring(0,6) + "..." + account.substring(account.length - 4);
                    statusText.style.color = "#4ade80";

                    connectBtn.style.display = "none";
                    verifyBtn.style.display = "block";
                } catch (error) {
                    statusText.innerText = "Status: Connection Denied";
                    statusText.style.color = "#f87171";
                }
            } else {
                alert("MetaMask required! Please install the extension.");
            }
        }

        async function enterLounge() {
            // Start ZK Simulation
            verifyBtn.disabled = true;
            verifyBtn.innerText = "üõ°Ô∏è Generating ZK-Witness...";
            statusText.innerText = "Status: Shielding Identity (SnarkJS)...";
            statusText.style.color = "#60a5fa";

            // Simulate the ZK-Proof math delay (3 seconds)
            await new Promise(resolve => setTimeout(resolve, 3000));

            statusText.innerText = "Status: Verification Successful!";
            statusText.style.color = "#4ade80";
            verifyBtn.innerText = "Access Granted!";

            // Final transition to the lounge
            setTimeout(() => {
                gatekeeper.style.display = "none";
                loungeContent.style.display = "block";
            }, 1000);
        }
    </script>
</body>
</html>